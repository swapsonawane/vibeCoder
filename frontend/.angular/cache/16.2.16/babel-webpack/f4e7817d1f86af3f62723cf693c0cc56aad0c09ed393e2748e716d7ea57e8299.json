{"ast":null,"code":"import { BehaviorSubject, of, delay } from 'rxjs';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"./auth.service\";\nimport * as i2 from \"./account.service\";\nimport * as i3 from \"./transfer.service\";\nimport * as i4 from \"./bill-payment.service\";\nimport * as i5 from \"./pdf-statement.service\";\nclass AiChatService {\n  constructor(authService, accountService, transferService, billPaymentService, pdfStatementService) {\n    this.authService = authService;\n    this.accountService = accountService;\n    this.transferService = transferService;\n    this.billPaymentService = billPaymentService;\n    this.pdfStatementService = pdfStatementService;\n    this.messagesSubject = new BehaviorSubject([]);\n    this.isTypingSubject = new BehaviorSubject(false);\n    this.chatSessionId = this.generateSessionId();\n    this.messages$ = this.messagesSubject.asObservable();\n    this.isTyping$ = this.isTypingSubject.asObservable();\n    // Banking-specific intents and responses\n    this.bankingIntents = {\n      'greeting': {\n        patterns: ['hello', 'hi', 'hey', 'good morning', 'good afternoon', 'start'],\n        responses: ['🧞‍♂️ Hello! I\\'m BankGenie, your magical banking assistant. What banking wish can I grant today?', '✨ Hi there! BankGenie at your service! Ready to make your banking dreams come true?', '🌟 Welcome! I\\'m BankGenie, here to work some banking magic for you. What can I help with?'],\n        quickReplies: ['Check Balance', 'Recent Transactions', 'Transfer Money', 'Pay Bills']\n      },\n      'balance_inquiry': {\n        patterns: ['balance', 'how much', 'account balance', 'check balance', 'money'],\n        responses: ['✨ Abracadabra! Let me reveal your account treasures...', '🔮 Gazing into your financial crystal ball...', '💰 Your wish is my command! Summoning your account balances...'],\n        requiresAuth: true\n      },\n      'transaction_history': {\n        patterns: ['transaction history', 'recent transactions', 'transaction statement', 'spending history', 'payment history'],\n        responses: ['📜 Unrolling the magical scroll of your recent transactions...', '🔍 Peering into your financial timeline...', '⏰ Time magic activated! Here\\'s your transaction history...'],\n        requiresAuth: true\n      },\n      'transfer_money': {\n        patterns: ['transfer', 'send money', 'move money', 'pay someone'],\n        responses: ['💫 Money teleportation magic! Which account shall we transfer from?', '🪄 Ready to cast a money transfer spell! Choose your source account...', '✨ Your transfer wish is my command! Let\\'s move some magical money...'],\n        requiresAuth: true,\n        quickReplies: ['Between My Accounts', 'To Another Person', 'External Transfer']\n      },\n      'bill_payment': {\n        patterns: ['pay bill', 'bills', 'payments', 'utilities'],\n        responses: ['🧾 Summoning your bill payment portal! Let me show you what needs attention...', '💳 Bill payment magic in progress! Here are your pending bills...', '⚡ Zapping away those bills! Let\\'s see what\\'s due...'],\n        requiresAuth: true\n      },\n      'help': {\n        patterns: ['help', 'what can you do', 'commands', 'assist'],\n        responses: ['🧞‍♂️ BankGenie at your service! I can grant these banking wishes: ✨ Account balances ✨ Transaction history ✨ Money transfers ✨ Bill payments ✨ Digital wallet ✨ QR payments ✨ Crypto portfolio ✨ Loyalty rewards ✨ Social payments ✨ Contactless magic ✨ Download statements ✨ Tax documents and much more!'],\n        quickReplies: ['Check Balance', 'Download Statement', 'Digital Wallet', 'QR Payments']\n      },\n      'account_info': {\n        patterns: ['account', 'account info', 'my accounts', 'account details'],\n        responses: ['🏦 Opening the vault of account wisdom! Here\\'s your complete account overview...', '📋 Your account secrets revealed! Let me show you everything...', '🔐 Unlocking your account treasury! Here are all the details...'],\n        requiresAuth: true\n      },\n      'digital_wallet': {\n        patterns: ['digital wallet', 'wallet', 'mobile wallet', 'e-wallet', 'digital money'],\n        responses: ['📱 Summoning your digital wallet portal! Here\\'s your mobile money magic...', '💳 Opening your digital treasure chest! Your e-wallet awaits...', '🎆 Digital wallet magic activated! Here are all your mobile payment options...'],\n        requiresAuth: true,\n        quickReplies: ['Add Money', 'Send Money', 'QR Payment', 'Transaction History']\n      },\n      'qr_payments': {\n        patterns: ['qr', 'qr code', 'qr payment', 'scan', 'quick response', 'qr money'],\n        responses: ['📱 QR Magic activated! Ready to scan or generate payment codes...', '🔲 Conjuring QR payment portal! Your instant payment magic...', '⚡ QR code wizardry in progress! Scan or create payment codes...'],\n        requiresAuth: true,\n        quickReplies: ['Generate QR', 'Scan QR', 'QR History']\n      },\n      'cryptocurrency': {\n        patterns: ['crypto', 'bitcoin', 'ethereum', 'cryptocurrency', 'crypto wallet', 'digital currency'],\n        responses: ['₿ Crypto crystal ball activated! Peering into your digital currency realm...', '🚀 Blockchain magic engaged! Here\\'s your cryptocurrency overview...', '💎 Digital gold vault unlocked! Your crypto treasures revealed...'],\n        requiresAuth: true,\n        quickReplies: ['Portfolio', 'Market Prices', 'Buy Crypto', 'Crypto News']\n      },\n      'loyalty_points': {\n        patterns: ['loyalty', 'points', 'rewards', 'cashback', 'loyalty program', 'reward points'],\n        responses: ['🌟 Loyalty magic sparkles! Your reward treasures await...', '🎁 Points paradise opened! Here are all your magical rewards...', '✨ Reward spell activated! Your loyalty treasures revealed...'],\n        requiresAuth: true,\n        quickReplies: ['View Points', 'Redeem Rewards', 'Earning History', 'Special Offers']\n      },\n      'social_payments': {\n        patterns: ['social', 'request money', 'social media', 'facebook pay', 'instagram pay', 'social transfer'],\n        responses: ['📲 Social payment magic! Connect with friends for money transfers...', '👥 Social money spells activated! Request or send via social media...', '🌐 Social banking portal opened! Your friend-to-friend payment magic...'],\n        requiresAuth: true,\n        quickReplies: ['Request Money', 'Social Send', 'Split Bill', 'Contact Friends']\n      },\n      'contactless_payments': {\n        patterns: ['contactless', 'nfc', 'tap to pay', 'touchless', 'proximity payment', 'near field'],\n        responses: ['📡 Contactless magic waves activated! Tap-to-pay powers engaged...', '🔗 NFC spells conjured! Your touchless payment magic ready...', '⚡ Proximity payment portal opened! Wave your device to pay...'],\n        requiresAuth: true,\n        quickReplies: ['Enable NFC', 'Payment Limits', 'Transaction History', 'Security Settings']\n      },\n      'account_statement': {\n        patterns: ['account statement', 'statement', 'bank statement', 'monthly statement', 'account summary', 'download statement', 'get statement', 'statement download'],\n        responses: ['📄 Summoning your account statement scroll! Let me conjure your financial records...', '📋 Magical statement generation in progress! Your account details are being assembled...', '🧾 Abracadabra! Your account statement is materializing...'],\n        requiresAuth: true,\n        quickReplies: ['This Month', 'Last Month', 'Last 3 Months', 'Custom Period']\n      },\n      'transaction_report': {\n        patterns: ['transaction report', 'transaction statement', 'spending report', 'expense report', 'transaction history', 'recent transactions', 'spending history'],\n        responses: ['📊 Conjuring your transaction magic report! All your spending spells revealed...', '💳 Transaction history scroll unrolling! Your financial journey awaits...', '📈 Magical transaction analysis in progress! Every penny accounted for...'],\n        requiresAuth: true,\n        quickReplies: ['Last 30 Days', 'Last 90 Days', 'This Year', 'Custom Range']\n      },\n      'tax_statement': {\n        patterns: ['tax statement', 'tax report', 'tax document', 'annual tax', 'tax summary', 'tax papers', 'tax docs', 'tax forms'],\n        responses: ['🧾 Tax magic activated! Summoning your annual tax documents...', '📋 Tax scroll materializing! All your tax-related treasures compiled...', '💰 Tax statement spell casting! Your financial tax data organized...'],\n        requiresAuth: true,\n        quickReplies: ['Current Year', 'Previous Year', 'Last 2 Years', 'Email Statement']\n      },\n      'loan_statement': {\n        patterns: ['loan statement', 'emi statement', 'loan report', 'mortgage statement', 'loan details', 'emi details', 'loan summary'],\n        responses: ['🏠 Loan magic scroll appearing! Your EMI journey documented...', '💸 Loan statement spell activated! Every payment magically tracked...', '📊 Mortgage magic report! Your loan adventure summarized...'],\n        requiresAuth: true,\n        quickReplies: ['EMI History', 'Outstanding Balance', 'Payment Schedule', 'Loan Summary']\n      },\n      'investment_statement': {\n        patterns: ['investment statement', 'portfolio statement', 'investment report', 'portfolio summary', 'investment summary', 'portfolio report'],\n        responses: ['📈 Investment magic portfolio materializing! Your wealth spells revealed...', '💎 Portfolio statement conjured! Your investment treasures detailed...', '🚀 Investment report magic! Your financial growth journey mapped...'],\n        requiresAuth: true,\n        quickReplies: ['Portfolio Summary', 'Performance Report', 'Dividend History', 'Capital Gains']\n      },\n      'download_statement': {\n        patterns: ['download statement', 'get statement', 'statement pdf', 'download report', 'download account statement', 'download transaction report', 'download tax statement', 'statement download'],\n        responses: ['⬇️ Download magic activated! Your statement will appear in your device...', '📥 Statement download spell cast! Materializing your document...', '💾 Digital statement magic! Your PDF is being conjured...'],\n        requiresAuth: true,\n        quickReplies: ['Account Statement', 'Transaction Report', 'Tax Document', 'Investment Report']\n      }\n    };\n    this.initializeChat();\n  }\n  initializeChat() {\n    const welcomeMessage = {\n      id: this.generateMessageId(),\n      content: '🧞‍♂️ Welcome! I\\'m BankGenie, your magical banking assistant! I can grant your wishes for account info, transfers, bill payments, and much more. What banking magic can I help you with today?',\n      timestamp: new Date(),\n      isFromUser: false,\n      type: 'text',\n      quickReplies: ['Check Balance', 'Recent Transactions', 'Transfer Money', 'Pay Bills', 'Help'],\n      intent: 'greeting'\n    };\n    this.messagesSubject.next([welcomeMessage]);\n  }\n  sendMessage(content) {\n    const userMessage = {\n      id: this.generateMessageId(),\n      content: content,\n      timestamp: new Date(),\n      isFromUser: true,\n      type: 'text'\n    };\n    // Add user message to chat\n    const currentMessages = this.messagesSubject.value;\n    this.messagesSubject.next([...currentMessages, userMessage]);\n    // Show typing indicator\n    this.isTypingSubject.next(true);\n    // Process message and generate response\n    return this.processMessage(content).pipe(delay(1500) // Simulate AI thinking time\n    );\n  }\n\n  processMessage(content) {\n    const intent = this.detectIntent(content);\n    const response = this.generateResponse(intent, content);\n    return of(response);\n  }\n  detectIntent(message) {\n    const lowerMessage = message.toLowerCase();\n    let bestMatch = {\n      intent: 'unknown',\n      confidence: 0.1,\n      entities: {}\n    };\n    // First, check for exact phrase matches (highest priority)\n    for (const [intentName, intentData] of Object.entries(this.bankingIntents)) {\n      for (const pattern of intentData.patterns) {\n        if (lowerMessage.includes(pattern)) {\n          return {\n            intent: intentName,\n            confidence: 0.95,\n            entities: this.extractEntities(message, intentName)\n          };\n        }\n      }\n    }\n    // Second, check for key word combinations (medium priority)\n    for (const [intentName, intentData] of Object.entries(this.bankingIntents)) {\n      for (const pattern of intentData.patterns) {\n        const patternWords = pattern.split(' ');\n        // Skip single word patterns in this phase to avoid false matches\n        if (patternWords.length === 1) continue;\n        const messageWords = lowerMessage.split(' ');\n        const matchedWords = patternWords.filter(word => messageWords.some(messageWord => messageWord === word || word.length > 3 && messageWord.includes(word) || messageWord.length > 3 && word.includes(messageWord)));\n        const matchScore = matchedWords.length / patternWords.length;\n        // Require at least 70% match for multi-word patterns\n        if (matchScore >= 0.7 && matchScore > bestMatch.confidence) {\n          bestMatch = {\n            intent: intentName,\n            confidence: matchScore * 0.8,\n            entities: this.extractEntities(message, intentName)\n          };\n        }\n      }\n    }\n    // Third, specific keyword-based detection (lowest priority, most specific)\n    if (bestMatch.confidence < 0.6) {\n      // Statement-related requests (must be very specific)\n      if ((lowerMessage.includes('statement') || lowerMessage.includes('download')) && (lowerMessage.includes('account') || lowerMessage.includes('bank'))) {\n        return {\n          intent: 'account_statement',\n          confidence: 0.75,\n          entities: this.extractEntities(message, 'account_statement')\n        };\n      }\n      if ((lowerMessage.includes('statement') || lowerMessage.includes('report')) && lowerMessage.includes('transaction')) {\n        return {\n          intent: 'transaction_report',\n          confidence: 0.75,\n          entities: this.extractEntities(message, 'transaction_report')\n        };\n      }\n      if (lowerMessage.includes('statement') && lowerMessage.includes('tax')) {\n        return {\n          intent: 'tax_statement',\n          confidence: 0.75,\n          entities: this.extractEntities(message, 'tax_statement')\n        };\n      }\n      // Balance inquiries\n      if ((lowerMessage.includes('balance') || lowerMessage.includes('money')) && (lowerMessage.includes('check') || lowerMessage.includes('show') || lowerMessage.includes('how much'))) {\n        return {\n          intent: 'balance_inquiry',\n          confidence: 0.75,\n          entities: this.extractEntities(message, 'balance_inquiry')\n        };\n      }\n      // Transaction history (be more specific)\n      if (lowerMessage.includes('transaction') && lowerMessage.includes('history') || lowerMessage.includes('recent') && lowerMessage.includes('transaction')) {\n        return {\n          intent: 'transaction_history',\n          confidence: 0.7,\n          entities: this.extractEntities(message, 'transaction_history')\n        };\n      }\n      // Generic statement download (only if explicitly mentioned)\n      if (lowerMessage.includes('download') && lowerMessage.includes('statement') || lowerMessage.includes('get') && lowerMessage.includes('statement')) {\n        return {\n          intent: 'download_statement',\n          confidence: 0.65,\n          entities: this.extractEntities(message, 'download_statement')\n        };\n      }\n    }\n    // Return best match only if confidence is reasonable\n    return bestMatch.confidence > 0.6 ? bestMatch : {\n      intent: 'unknown',\n      confidence: 0.1\n    };\n  }\n  extractEntities(message, intent) {\n    const entities = {};\n    const lowerMessage = message.toLowerCase();\n    // Extract amounts\n    const amountMatch = message.match(/\\$?(\\d+(?:,\\d{3})*(?:\\.\\d{2})?)/);\n    if (amountMatch) {\n      entities['amount'] = parseFloat(amountMatch[1].replace(/,/g, ''));\n    }\n    // Extract account types\n    if (lowerMessage.includes('saving')) entities['accountType'] = 'SAVINGS';\n    if (lowerMessage.includes('checking')) entities['accountType'] = 'CHECKING';\n    return entities;\n  }\n  generateResponse(intent, originalMessage) {\n    const intentData = this.bankingIntents[intent.intent];\n    let response;\n    if (!intentData) {\n      response = this.generateUnknownResponse(originalMessage);\n    } else if (intentData.requiresAuth && !this.authService.getToken()) {\n      response = this.generateAuthRequiredResponse();\n    } else {\n      response = this.generateIntentResponse(intent, intentData);\n    }\n    // Add response to chat and hide typing indicator\n    setTimeout(() => {\n      const currentMessages = this.messagesSubject.value;\n      this.messagesSubject.next([...currentMessages, response]);\n      this.isTypingSubject.next(false);\n    }, 100);\n    return response;\n  }\n  generateIntentResponse(intent, intentData) {\n    const randomResponse = intentData.responses[Math.floor(Math.random() * intentData.responses.length)];\n    const response = {\n      id: this.generateMessageId(),\n      content: randomResponse,\n      timestamp: new Date(),\n      isFromUser: false,\n      type: 'text',\n      intent: intent.intent,\n      quickReplies: intentData.quickReplies\n    };\n    // Add special handling for specific intents\n    switch (intent.intent) {\n      case 'balance_inquiry':\n        response.type = 'card';\n        response.cardData = this.generateBalanceCard();\n        break;\n      case 'transaction_history':\n        response.type = 'card';\n        response.cardData = this.generateTransactionCard();\n        break;\n      case 'account_info':\n        response.type = 'card';\n        response.cardData = this.generateAccountCard();\n        break;\n      case 'digital_wallet':\n        response.type = 'card';\n        response.cardData = this.generateDigitalWalletCard();\n        break;\n      case 'qr_payments':\n        response.type = 'card';\n        response.cardData = this.generateQRPaymentCard();\n        break;\n      case 'cryptocurrency':\n        response.type = 'card';\n        response.cardData = this.generateCryptoWalletCard();\n        break;\n      case 'loyalty_points':\n        response.type = 'card';\n        response.cardData = this.generateLoyaltyPointsCard();\n        break;\n      case 'social_payments':\n        response.type = 'card';\n        response.cardData = this.generateSocialPaymentsCard();\n        break;\n      case 'contactless_payments':\n        response.type = 'card';\n        response.cardData = this.generateContactlessPaymentsCard();\n        break;\n      case 'account_statement':\n        response.type = 'card';\n        response.cardData = this.generateStatementDownloadCard('account');\n        break;\n      case 'transaction_report':\n        response.type = 'card';\n        response.cardData = this.generateStatementDownloadCard('transaction');\n        break;\n      case 'tax_statement':\n        response.type = 'card';\n        response.cardData = this.generateStatementDownloadCard('tax');\n        break;\n      case 'loan_statement':\n        response.type = 'card';\n        response.cardData = this.generateStatementDownloadCard('loan');\n        break;\n      case 'investment_statement':\n        response.type = 'card';\n        response.cardData = this.generateStatementDownloadCard('investment');\n        break;\n      case 'download_statement':\n        response.type = 'card';\n        response.cardData = this.generateStatementOptionsCard();\n        break;\n    }\n    return response;\n  }\n  generateBalanceCard() {\n    // Mock account data - in real app, this would come from AccountService\n    return {\n      type: 'balance',\n      accounts: [{\n        name: 'Savings Account',\n        number: '****4567',\n        balance: 15750.50\n      }, {\n        name: 'Checking Account',\n        number: '****4568',\n        balance: 8240.25\n      }],\n      totalBalance: 23990.75\n    };\n  }\n  generateTransactionCard() {\n    return {\n      type: 'transactions',\n      transactions: [{\n        description: 'Coffee Shop',\n        amount: -4.50,\n        date: new Date(),\n        category: 'Food & Dining'\n      }, {\n        description: 'Salary Deposit',\n        amount: 3500.00,\n        date: new Date(Date.now() - 86400000),\n        category: 'Income'\n      }, {\n        description: 'Electric Bill',\n        amount: -85.50,\n        date: new Date(Date.now() - 172800000),\n        category: 'Utilities'\n      }]\n    };\n  }\n  generateAccountCard() {\n    return {\n      type: 'accounts',\n      accounts: [{\n        type: 'Savings',\n        number: 'ACC1001234567',\n        balance: 15750.50,\n        status: 'Active',\n        openDate: '2020-01-15'\n      }, {\n        type: 'Checking',\n        number: 'ACC1001234568',\n        balance: 8240.25,\n        status: 'Active',\n        openDate: '2020-01-15'\n      }]\n    };\n  }\n  generateUnknownResponse(message) {\n    const responses = ['🤔 Hmm, that wish is beyond my magical powers! Could you try rephrasing it?', '🧞‍♂️ My genie magic didn\\'t catch that! Can you ask about accounts, transfers, or bill payments?', '✨ I\\'m still learning new spells! Try asking about balances, transactions, or money transfers.', '🔮 The crystal ball is a bit cloudy on that one! Please ask about banking topics.'];\n    return {\n      id: this.generateMessageId(),\n      content: responses[Math.floor(Math.random() * responses.length)],\n      timestamp: new Date(),\n      isFromUser: false,\n      type: 'text',\n      quickReplies: ['Check Balance', 'Transfer Money', 'Pay Bills', 'Help'],\n      intent: 'unknown'\n    };\n  }\n  generateAuthRequiredResponse() {\n    return {\n      id: this.generateMessageId(),\n      content: '🔐 Oops! I need you to be logged into your magical banking realm first. Please sign in to unlock my full genie powers!',\n      timestamp: new Date(),\n      isFromUser: false,\n      type: 'text',\n      intent: 'auth_required'\n    };\n  }\n  clearChat() {\n    this.messagesSubject.next([]);\n    this.initializeChat();\n  }\n  generateMessageId() {\n    return 'msg_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);\n  }\n  generateSessionId() {\n    return 'session_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);\n  }\n  getMessages() {\n    return this.messagesSubject.value;\n  }\n  // Modern Banking Features Card Generators\n  generateDigitalWalletCard() {\n    return {\n      type: 'digital_wallet',\n      walletBalance: 1250.75,\n      linkedCards: [{\n        type: 'Visa',\n        last4: '4532',\n        isDefault: true\n      }, {\n        type: 'Mastercard',\n        last4: '8901',\n        isDefault: false\n      }],\n      recentTransactions: [{\n        merchant: 'Starbucks Coffee',\n        amount: -5.49,\n        date: new Date(),\n        method: 'Tap to Pay'\n      }, {\n        merchant: 'Uber Ride',\n        amount: -12.30,\n        date: new Date(Date.now() - 3600000),\n        method: 'Digital Wallet'\n      }, {\n        merchant: 'Amazon Purchase',\n        amount: -89.99,\n        date: new Date(Date.now() - 7200000),\n        method: 'Online Payment'\n      }],\n      features: ['Tap to Pay', 'QR Payments', 'P2P Transfers', 'Bill Splitting']\n    };\n  }\n  generateQRPaymentCard() {\n    return {\n      type: 'qr_payments',\n      qrCode: 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTAwIiBoZWlnaHQ9IjEwMCI+PGcgZmlsbD0iIzAwMCI+PHJlY3Qgd2lkdGg9IjEwMCIgaGVpZ2h0PSIxMDAiLz48L2c+PC9zdmc+',\n      paymentAmount: 0,\n      merchantName: 'QuickPay QR',\n      recentQRPayments: [{\n        merchant: 'Local Coffee Shop',\n        amount: 8.50,\n        date: new Date(),\n        success: true\n      }, {\n        merchant: 'Street Food Vendor',\n        amount: 15.75,\n        date: new Date(Date.now() - 86400000),\n        success: true\n      }, {\n        merchant: 'Parking Meter',\n        amount: 2.00,\n        date: new Date(Date.now() - 172800000),\n        success: true\n      }],\n      features: ['Instant QR Generation', 'Scan & Pay', 'Merchant QR', 'P2P QR Codes']\n    };\n  }\n  generateCryptoWalletCard() {\n    return {\n      type: 'crypto_wallet',\n      totalValue: 4567.89,\n      currencies: [{\n        name: 'Bitcoin',\n        symbol: 'BTC',\n        amount: 0.0789,\n        value: 2845.32,\n        change: +5.67\n      }, {\n        name: 'Ethereum',\n        symbol: 'ETH',\n        amount: 1.2456,\n        value: 1432.87,\n        change: -2.34\n      }, {\n        name: 'Cardano',\n        symbol: 'ADA',\n        amount: 1250.00,\n        value: 289.70,\n        change: +12.45\n      }],\n      features: ['View Only', 'Price Tracking', 'Portfolio Analytics', 'Market News']\n    };\n  }\n  generateLoyaltyPointsCard() {\n    return {\n      type: 'loyalty_points',\n      totalPoints: 15750,\n      cashValue: 157.50,\n      tier: 'Gold Member',\n      pointsToNextTier: 4250,\n      recentEarnings: [{\n        source: 'Credit Card Purchase',\n        points: 125,\n        date: new Date()\n      }, {\n        source: 'Monthly Bonus',\n        points: 500,\n        date: new Date(Date.now() - 86400000)\n      }, {\n        source: 'Referral Bonus',\n        points: 1000,\n        date: new Date(Date.now() - 172800000)\n      }],\n      availableRewards: [{\n        name: '$10 Cashback',\n        cost: 1000,\n        category: 'Cash'\n      }, {\n        name: 'Coffee Voucher',\n        cost: 500,\n        category: 'Food'\n      }, {\n        name: 'Movie Ticket',\n        cost: 1500,\n        category: 'Entertainment'\n      }]\n    };\n  }\n  generateSocialPaymentsCard() {\n    return {\n      type: 'social_payments',\n      connectedPlatforms: ['Facebook', 'Instagram', 'WhatsApp', 'Telegram'],\n      recentRequests: [{\n        friend: 'John Smith',\n        amount: 25.00,\n        reason: 'Dinner split',\n        status: 'pending'\n      }, {\n        friend: 'Sarah Wilson',\n        amount: 15.50,\n        reason: 'Movie tickets',\n        status: 'completed'\n      }, {\n        friend: 'Mike Johnson',\n        amount: 40.00,\n        reason: 'Gas money',\n        status: 'completed'\n      }],\n      quickActions: ['Request Money', 'Send Money', 'Split Bill', 'Group Payment'],\n      socialFeatures: ['Contact Integration', 'Payment Reminders', 'Social Feed', 'Group Chats']\n    };\n  }\n  generateContactlessPaymentsCard() {\n    return {\n      type: 'contactless_payments',\n      nfcEnabled: true,\n      dailyLimit: 100.00,\n      dailyUsed: 23.45,\n      monthlyTransactions: 47,\n      recentContactless: [{\n        merchant: 'Metro Transit',\n        amount: 2.75,\n        date: new Date(),\n        method: 'NFC'\n      }, {\n        merchant: 'Grocery Store',\n        amount: 45.67,\n        date: new Date(Date.now() - 3600000),\n        method: 'Tap Card'\n      }, {\n        merchant: 'Gas Station',\n        amount: 15.00,\n        date: new Date(Date.now() - 7200000),\n        method: 'Mobile NFC'\n      }],\n      supportedMethods: ['NFC Phone', 'Contactless Card', 'Smartwatch', 'Wearables']\n    };\n  }\n  generateStatementDownloadCard(statementType) {\n    return {\n      type: 'statement_download',\n      statementType: statementType,\n      title: this.getStatementTitle(statementType),\n      description: this.getStatementDescription(statementType),\n      icon: this.getStatementIcon(statementType),\n      downloadOptions: [{\n        period: 'This Month',\n        filename: `${statementType}_statement_${new Date().getMonth() + 1}_${new Date().getFullYear()}`,\n        size: '245 KB'\n      }, {\n        period: 'Last Month',\n        filename: `${statementType}_statement_${new Date().getMonth()}_${new Date().getFullYear()}`,\n        size: '189 KB'\n      }, {\n        period: 'Last 3 Months',\n        filename: `${statementType}_statement_3months_${new Date().getFullYear()}`,\n        size: '567 KB'\n      }, {\n        period: 'Custom Period',\n        filename: `${statementType}_statement_custom`,\n        size: 'Variable'\n      }],\n      quickActions: ['Download PDF', 'Email Statement', 'View Online', 'Schedule Regular Delivery']\n    };\n  }\n  generateStatementOptionsCard() {\n    return {\n      type: 'statement_options',\n      title: '📋 Statement Magic Portal',\n      description: 'Choose your preferred statement type to conjure',\n      statementTypes: [{\n        type: 'account',\n        title: 'Account Statement',\n        description: 'Complete account summary with all transactions',\n        icon: '🏦',\n        color: '#4CAF50'\n      }, {\n        type: 'transaction',\n        title: 'Transaction Report',\n        description: 'Detailed spending and income analysis',\n        icon: '📊',\n        color: '#2196F3'\n      }, {\n        type: 'tax',\n        title: 'Tax Statement',\n        description: 'Annual tax documents and summaries',\n        icon: '🧾',\n        color: '#FF9800'\n      }, {\n        type: 'loan',\n        title: 'Loan Statement',\n        description: 'EMI history and outstanding balance',\n        icon: '🏠',\n        color: '#9C27B0'\n      }, {\n        type: 'investment',\n        title: 'Investment Report',\n        description: 'Portfolio performance and holdings',\n        icon: '📈',\n        color: '#F44336'\n      }, {\n        type: 'digital_wallet',\n        title: 'Digital Wallet Statement',\n        description: 'Mobile wallet transactions and balance',\n        icon: '📱',\n        color: '#00BCD4'\n      }]\n    };\n  }\n  getStatementTitle(type) {\n    const titles = {\n      'account': '🏦 Account Statement',\n      'transaction': '📊 Transaction Report',\n      'tax': '🧾 Tax Statement',\n      'loan': '🏠 Loan Statement',\n      'investment': '📈 Investment Report',\n      'digital_wallet': '📱 Digital Wallet Statement'\n    };\n    return titles[type] || '📄 Statement';\n  }\n  getStatementDescription(type) {\n    const descriptions = {\n      'account': 'Complete account summary with balance and transaction history',\n      'transaction': 'Detailed analysis of all your spending and income patterns',\n      'tax': 'Annual tax documents with interest and investment summaries',\n      'loan': 'EMI payment history and outstanding loan balance details',\n      'investment': 'Portfolio performance report with gains and holdings',\n      'digital_wallet': 'Mobile wallet transactions and payment history'\n    };\n    return descriptions[type] || 'Financial statement document';\n  }\n  getStatementIcon(type) {\n    const icons = {\n      'account': '🏦',\n      'transaction': '📊',\n      'tax': '🧾',\n      'loan': '🏠',\n      'investment': '📈',\n      'digital_wallet': '📱'\n    };\n    return icons[type] || '📄';\n  }\n  // Method to handle statement download requests\n  handleStatementDownload(statementType, period) {\n    const options = this.createStatementOptions(statementType, period);\n    switch (statementType) {\n      case 'account':\n        this.pdfStatementService.generateAccountStatement(options).subscribe(blob => {\n          this.pdfStatementService.downloadStatement(blob, `account-statement-${period.toLowerCase().replace(' ', '-')}`);\n        });\n        break;\n      case 'transaction':\n        this.pdfStatementService.generateTransactionHistory(options).subscribe(blob => {\n          this.pdfStatementService.downloadStatement(blob, `transaction-report-${period.toLowerCase().replace(' ', '-')}`);\n        });\n        break;\n      case 'tax':\n        this.pdfStatementService.generateTaxStatement(new Date().getFullYear()).subscribe(blob => {\n          this.pdfStatementService.downloadStatement(blob, `tax-statement-${new Date().getFullYear()}`);\n        });\n        break;\n      case 'loan':\n        this.pdfStatementService.generateLoanStatement('LOAN001', options).subscribe(blob => {\n          this.pdfStatementService.downloadStatement(blob, `loan-statement-${period.toLowerCase().replace(' ', '-')}`);\n        });\n        break;\n      case 'investment':\n        this.pdfStatementService.generateInvestmentStatement('PORTFOLIO001', options).subscribe(blob => {\n          this.pdfStatementService.downloadStatement(blob, `investment-report-${period.toLowerCase().replace(' ', '-')}`);\n        });\n        break;\n      case 'digital_wallet':\n        this.pdfStatementService.generateDigitalWalletStatement(options).subscribe(blob => {\n          this.pdfStatementService.downloadStatement(blob, `wallet-statement-${period.toLowerCase().replace(' ', '-')}`);\n        });\n        break;\n    }\n  }\n  createStatementOptions(statementType, period) {\n    const now = new Date();\n    let startDate;\n    let endDate = new Date(now);\n    switch (period) {\n      case 'This Month':\n        startDate = new Date(now.getFullYear(), now.getMonth(), 1);\n        break;\n      case 'Last Month':\n        startDate = new Date(now.getFullYear(), now.getMonth() - 1, 1);\n        endDate = new Date(now.getFullYear(), now.getMonth(), 0);\n        break;\n      case 'Last 3 Months':\n        startDate = new Date(now.getFullYear(), now.getMonth() - 3, 1);\n        break;\n      default:\n        startDate = new Date(now.getFullYear(), now.getMonth() - 1, 1);\n    }\n    return {\n      startDate,\n      endDate,\n      statementType: period === 'This Month' ? 'monthly' : 'custom',\n      format: 'pdf'\n    };\n  }\n  static {\n    this.ɵfac = function AiChatService_Factory(t) {\n      return new (t || AiChatService)(i0.ɵɵinject(i1.AuthService), i0.ɵɵinject(i2.AccountService), i0.ɵɵinject(i3.TransferService), i0.ɵɵinject(i4.BillPaymentService), i0.ɵɵinject(i5.PdfStatementService));\n    };\n  }\n  static {\n    this.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n      token: AiChatService,\n      factory: AiChatService.ɵfac,\n      providedIn: 'root'\n    });\n  }\n}\nexport { AiChatService };","map":{"version":3,"names":["BehaviorSubject","of","delay","AiChatService","constructor","authService","accountService","transferService","billPaymentService","pdfStatementService","messagesSubject","isTypingSubject","chatSessionId","generateSessionId","messages$","asObservable","isTyping$","bankingIntents","patterns","responses","quickReplies","requiresAuth","initializeChat","welcomeMessage","id","generateMessageId","content","timestamp","Date","isFromUser","type","intent","next","sendMessage","userMessage","currentMessages","value","processMessage","pipe","detectIntent","response","generateResponse","message","lowerMessage","toLowerCase","bestMatch","confidence","entities","intentName","intentData","Object","entries","pattern","includes","extractEntities","patternWords","split","length","messageWords","matchedWords","filter","word","some","messageWord","matchScore","amountMatch","match","parseFloat","replace","originalMessage","generateUnknownResponse","getToken","generateAuthRequiredResponse","generateIntentResponse","setTimeout","randomResponse","Math","floor","random","cardData","generateBalanceCard","generateTransactionCard","generateAccountCard","generateDigitalWalletCard","generateQRPaymentCard","generateCryptoWalletCard","generateLoyaltyPointsCard","generateSocialPaymentsCard","generateContactlessPaymentsCard","generateStatementDownloadCard","generateStatementOptionsCard","accounts","name","number","balance","totalBalance","transactions","description","amount","date","category","now","status","openDate","clearChat","toString","substr","getMessages","walletBalance","linkedCards","last4","isDefault","recentTransactions","merchant","method","features","qrCode","paymentAmount","merchantName","recentQRPayments","success","totalValue","currencies","symbol","change","totalPoints","cashValue","tier","pointsToNextTier","recentEarnings","source","points","availableRewards","cost","connectedPlatforms","recentRequests","friend","reason","quickActions","socialFeatures","nfcEnabled","dailyLimit","dailyUsed","monthlyTransactions","recentContactless","supportedMethods","statementType","title","getStatementTitle","getStatementDescription","icon","getStatementIcon","downloadOptions","period","filename","getMonth","getFullYear","size","statementTypes","color","titles","descriptions","icons","handleStatementDownload","options","createStatementOptions","generateAccountStatement","subscribe","blob","downloadStatement","generateTransactionHistory","generateTaxStatement","generateLoanStatement","generateInvestmentStatement","generateDigitalWalletStatement","startDate","endDate","format","i0","ɵɵinject","i1","AuthService","i2","AccountService","i3","TransferService","i4","BillPaymentService","i5","PdfStatementService","factory","ɵfac","providedIn"],"sources":["C:\\Users\\2419470\\vibeCoder\\frontend\\src\\app\\services\\ai-chat.service.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\r\nimport { BehaviorSubject, Observable, of, delay } from 'rxjs';\r\nimport { AuthService } from './auth.service';\r\nimport { AccountService } from './account.service';\r\nimport { TransferService } from './transfer.service';\r\nimport { BillPaymentService } from './bill-payment.service';\r\nimport { PdfStatementService, StatementOptions } from './pdf-statement.service';\r\n\r\nexport interface ChatMessage {\r\n  id: string;\r\n  content: string;\r\n  timestamp: Date;\r\n  isFromUser: boolean;\r\n  type: 'text' | 'quick-reply' | 'card' | 'transaction' | 'statement';\r\n  quickReplies?: string[];\r\n  cardData?: any;\r\n  intent?: string;\r\n}\r\n\r\nexport interface ChatIntent {\r\n  intent: string;\r\n  confidence: number;\r\n  entities?: { [key: string]: any };\r\n}\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class AiChatService {\r\n  private messagesSubject = new BehaviorSubject<ChatMessage[]>([]);\r\n  private isTypingSubject = new BehaviorSubject<boolean>(false);\r\n  private chatSessionId = this.generateSessionId();\r\n\r\n  public messages$ = this.messagesSubject.asObservable();\r\n  public isTyping$ = this.isTypingSubject.asObservable();\r\n\r\n  // Banking-specific intents and responses\r\n  private bankingIntents = {\r\n    'greeting': {\r\n      patterns: ['hello', 'hi', 'hey', 'good morning', 'good afternoon', 'start'],\r\n      responses: [\r\n        '🧞‍♂️ Hello! I\\'m BankGenie, your magical banking assistant. What banking wish can I grant today?',\r\n        '✨ Hi there! BankGenie at your service! Ready to make your banking dreams come true?',\r\n        '🌟 Welcome! I\\'m BankGenie, here to work some banking magic for you. What can I help with?'\r\n      ],\r\n      quickReplies: ['Check Balance', 'Recent Transactions', 'Transfer Money', 'Pay Bills']\r\n    },\r\n    'balance_inquiry': {\r\n      patterns: ['balance', 'how much', 'account balance', 'check balance', 'money'],\r\n      responses: ['✨ Abracadabra! Let me reveal your account treasures...', '🔮 Gazing into your financial crystal ball...', '💰 Your wish is my command! Summoning your account balances...'],\r\n      requiresAuth: true\r\n    },\r\n    'transaction_history': {\r\n      patterns: ['transaction history', 'recent transactions', 'transaction statement', 'spending history', 'payment history'],\r\n      responses: ['📜 Unrolling the magical scroll of your recent transactions...', '🔍 Peering into your financial timeline...', '⏰ Time magic activated! Here\\'s your transaction history...'],\r\n      requiresAuth: true\r\n    },\r\n    'transfer_money': {\r\n      patterns: ['transfer', 'send money', 'move money', 'pay someone'],\r\n      responses: ['💫 Money teleportation magic! Which account shall we transfer from?', '🪄 Ready to cast a money transfer spell! Choose your source account...', '✨ Your transfer wish is my command! Let\\'s move some magical money...'],\r\n      requiresAuth: true,\r\n      quickReplies: ['Between My Accounts', 'To Another Person', 'External Transfer']\r\n    },\r\n    'bill_payment': {\r\n      patterns: ['pay bill', 'bills', 'payments', 'utilities'],\r\n      responses: ['🧾 Summoning your bill payment portal! Let me show you what needs attention...', '💳 Bill payment magic in progress! Here are your pending bills...', '⚡ Zapping away those bills! Let\\'s see what\\'s due...'],\r\n      requiresAuth: true\r\n    },\r\n    'help': {\r\n      patterns: ['help', 'what can you do', 'commands', 'assist'],\r\n      responses: ['🧞‍♂️ BankGenie at your service! I can grant these banking wishes: ✨ Account balances ✨ Transaction history ✨ Money transfers ✨ Bill payments ✨ Digital wallet ✨ QR payments ✨ Crypto portfolio ✨ Loyalty rewards ✨ Social payments ✨ Contactless magic ✨ Download statements ✨ Tax documents and much more!'],\r\n      quickReplies: ['Check Balance', 'Download Statement', 'Digital Wallet', 'QR Payments']\r\n    },\r\n    'account_info': {\r\n      patterns: ['account', 'account info', 'my accounts', 'account details'],\r\n      responses: ['🏦 Opening the vault of account wisdom! Here\\'s your complete account overview...', '📋 Your account secrets revealed! Let me show you everything...', '🔐 Unlocking your account treasury! Here are all the details...'],\r\n      requiresAuth: true\r\n    },\r\n    'digital_wallet': {\r\n      patterns: ['digital wallet', 'wallet', 'mobile wallet', 'e-wallet', 'digital money'],\r\n      responses: ['📱 Summoning your digital wallet portal! Here\\'s your mobile money magic...', '💳 Opening your digital treasure chest! Your e-wallet awaits...', '🎆 Digital wallet magic activated! Here are all your mobile payment options...'],\r\n      requiresAuth: true,\r\n      quickReplies: ['Add Money', 'Send Money', 'QR Payment', 'Transaction History']\r\n    },\r\n    'qr_payments': {\r\n      patterns: ['qr', 'qr code', 'qr payment', 'scan', 'quick response', 'qr money'],\r\n      responses: ['📱 QR Magic activated! Ready to scan or generate payment codes...', '🔲 Conjuring QR payment portal! Your instant payment magic...', '⚡ QR code wizardry in progress! Scan or create payment codes...'],\r\n      requiresAuth: true,\r\n      quickReplies: ['Generate QR', 'Scan QR', 'QR History']\r\n    },\r\n    'cryptocurrency': {\r\n      patterns: ['crypto', 'bitcoin', 'ethereum', 'cryptocurrency', 'crypto wallet', 'digital currency'],\r\n      responses: ['₿ Crypto crystal ball activated! Peering into your digital currency realm...', '🚀 Blockchain magic engaged! Here\\'s your cryptocurrency overview...', '💎 Digital gold vault unlocked! Your crypto treasures revealed...'],\r\n      requiresAuth: true,\r\n      quickReplies: ['Portfolio', 'Market Prices', 'Buy Crypto', 'Crypto News']\r\n    },\r\n    'loyalty_points': {\r\n      patterns: ['loyalty', 'points', 'rewards', 'cashback', 'loyalty program', 'reward points'],\r\n      responses: ['🌟 Loyalty magic sparkles! Your reward treasures await...', '🎁 Points paradise opened! Here are all your magical rewards...', '✨ Reward spell activated! Your loyalty treasures revealed...'],\r\n      requiresAuth: true,\r\n      quickReplies: ['View Points', 'Redeem Rewards', 'Earning History', 'Special Offers']\r\n    },\r\n    'social_payments': {\r\n      patterns: ['social', 'request money', 'social media', 'facebook pay', 'instagram pay', 'social transfer'],\r\n      responses: ['📲 Social payment magic! Connect with friends for money transfers...', '👥 Social money spells activated! Request or send via social media...', '🌐 Social banking portal opened! Your friend-to-friend payment magic...'],\r\n      requiresAuth: true,\r\n      quickReplies: ['Request Money', 'Social Send', 'Split Bill', 'Contact Friends']\r\n    },\r\n    'contactless_payments': {\r\n      patterns: ['contactless', 'nfc', 'tap to pay', 'touchless', 'proximity payment', 'near field'],\r\n      responses: ['📡 Contactless magic waves activated! Tap-to-pay powers engaged...', '🔗 NFC spells conjured! Your touchless payment magic ready...', '⚡ Proximity payment portal opened! Wave your device to pay...'],\r\n      requiresAuth: true,\r\n      quickReplies: ['Enable NFC', 'Payment Limits', 'Transaction History', 'Security Settings']\r\n    },\r\n    'account_statement': {\r\n      patterns: ['account statement', 'statement', 'bank statement', 'monthly statement', 'account summary', 'download statement', 'get statement', 'statement download'],\r\n      responses: ['📄 Summoning your account statement scroll! Let me conjure your financial records...', '📋 Magical statement generation in progress! Your account details are being assembled...', '🧾 Abracadabra! Your account statement is materializing...'],\r\n      requiresAuth: true,\r\n      quickReplies: ['This Month', 'Last Month', 'Last 3 Months', 'Custom Period']\r\n    },\r\n    'transaction_report': {\r\n      patterns: ['transaction report', 'transaction statement', 'spending report', 'expense report', 'transaction history', 'recent transactions', 'spending history'],\r\n      responses: ['📊 Conjuring your transaction magic report! All your spending spells revealed...', '💳 Transaction history scroll unrolling! Your financial journey awaits...', '📈 Magical transaction analysis in progress! Every penny accounted for...'],\r\n      requiresAuth: true,\r\n      quickReplies: ['Last 30 Days', 'Last 90 Days', 'This Year', 'Custom Range']\r\n    },\r\n    'tax_statement': {\r\n      patterns: ['tax statement', 'tax report', 'tax document', 'annual tax', 'tax summary', 'tax papers', 'tax docs', 'tax forms'],\r\n      responses: ['🧾 Tax magic activated! Summoning your annual tax documents...', '📋 Tax scroll materializing! All your tax-related treasures compiled...', '💰 Tax statement spell casting! Your financial tax data organized...'],\r\n      requiresAuth: true,\r\n      quickReplies: ['Current Year', 'Previous Year', 'Last 2 Years', 'Email Statement']\r\n    },\r\n    'loan_statement': {\r\n      patterns: ['loan statement', 'emi statement', 'loan report', 'mortgage statement', 'loan details', 'emi details', 'loan summary'],\r\n      responses: ['🏠 Loan magic scroll appearing! Your EMI journey documented...', '💸 Loan statement spell activated! Every payment magically tracked...', '📊 Mortgage magic report! Your loan adventure summarized...'],\r\n      requiresAuth: true,\r\n      quickReplies: ['EMI History', 'Outstanding Balance', 'Payment Schedule', 'Loan Summary']\r\n    },\r\n    'investment_statement': {\r\n      patterns: ['investment statement', 'portfolio statement', 'investment report', 'portfolio summary', 'investment summary', 'portfolio report'],\r\n      responses: ['📈 Investment magic portfolio materializing! Your wealth spells revealed...', '💎 Portfolio statement conjured! Your investment treasures detailed...', '🚀 Investment report magic! Your financial growth journey mapped...'],\r\n      requiresAuth: true,\r\n      quickReplies: ['Portfolio Summary', 'Performance Report', 'Dividend History', 'Capital Gains']\r\n    },\r\n    'download_statement': {\r\n      patterns: ['download statement', 'get statement', 'statement pdf', 'download report', 'download account statement', 'download transaction report', 'download tax statement', 'statement download'],\r\n      responses: ['⬇️ Download magic activated! Your statement will appear in your device...', '📥 Statement download spell cast! Materializing your document...', '💾 Digital statement magic! Your PDF is being conjured...'],\r\n      requiresAuth: true,\r\n      quickReplies: ['Account Statement', 'Transaction Report', 'Tax Document', 'Investment Report']\r\n    }\r\n  };\r\n\r\n  constructor(\r\n    private authService: AuthService,\r\n    private accountService: AccountService,\r\n    private transferService: TransferService,\r\n    private billPaymentService: BillPaymentService,\r\n    private pdfStatementService: PdfStatementService\r\n  ) {\r\n    this.initializeChat();\r\n  }\r\n\r\n  private initializeChat(): void {\r\n    const welcomeMessage: ChatMessage = {\r\n      id: this.generateMessageId(),\r\n      content: '🧞‍♂️ Welcome! I\\'m BankGenie, your magical banking assistant! I can grant your wishes for account info, transfers, bill payments, and much more. What banking magic can I help you with today?',\r\n      timestamp: new Date(),\r\n      isFromUser: false,\r\n      type: 'text',\r\n      quickReplies: ['Check Balance', 'Recent Transactions', 'Transfer Money', 'Pay Bills', 'Help'],\r\n      intent: 'greeting'\r\n    };\r\n    \r\n    this.messagesSubject.next([welcomeMessage]);\r\n  }\r\n\r\n  sendMessage(content: string): Observable<ChatMessage> {\r\n    const userMessage: ChatMessage = {\r\n      id: this.generateMessageId(),\r\n      content: content,\r\n      timestamp: new Date(),\r\n      isFromUser: true,\r\n      type: 'text'\r\n    };\r\n\r\n    // Add user message to chat\r\n    const currentMessages = this.messagesSubject.value;\r\n    this.messagesSubject.next([...currentMessages, userMessage]);\r\n\r\n    // Show typing indicator\r\n    this.isTypingSubject.next(true);\r\n\r\n    // Process message and generate response\r\n    return this.processMessage(content).pipe(\r\n      delay(1500) // Simulate AI thinking time\r\n    );\r\n  }\r\n\r\n  private processMessage(content: string): Observable<ChatMessage> {\r\n    const intent = this.detectIntent(content);\r\n    const response = this.generateResponse(intent, content);\r\n\r\n    return of(response);\r\n  }\r\n\r\n  private detectIntent(message: string): ChatIntent {\r\n    const lowerMessage = message.toLowerCase();\r\n    let bestMatch = { intent: 'unknown', confidence: 0.1, entities: {} };\r\n    \r\n    // First, check for exact phrase matches (highest priority)\r\n    for (const [intentName, intentData] of Object.entries(this.bankingIntents)) {\r\n      for (const pattern of intentData.patterns) {\r\n        if (lowerMessage.includes(pattern)) {\r\n          return {\r\n            intent: intentName,\r\n            confidence: 0.95,\r\n            entities: this.extractEntities(message, intentName)\r\n          };\r\n        }\r\n      }\r\n    }\r\n    \r\n    // Second, check for key word combinations (medium priority)\r\n    for (const [intentName, intentData] of Object.entries(this.bankingIntents)) {\r\n      for (const pattern of intentData.patterns) {\r\n        const patternWords = pattern.split(' ');\r\n        \r\n        // Skip single word patterns in this phase to avoid false matches\r\n        if (patternWords.length === 1) continue;\r\n        \r\n        const messageWords = lowerMessage.split(' ');\r\n        const matchedWords = patternWords.filter(word => \r\n          messageWords.some(messageWord => \r\n            messageWord === word || \r\n            (word.length > 3 && messageWord.includes(word)) ||\r\n            (messageWord.length > 3 && word.includes(messageWord))\r\n          )\r\n        );\r\n        \r\n        const matchScore = matchedWords.length / patternWords.length;\r\n        \r\n        // Require at least 70% match for multi-word patterns\r\n        if (matchScore >= 0.7 && matchScore > bestMatch.confidence) {\r\n          bestMatch = {\r\n            intent: intentName,\r\n            confidence: matchScore * 0.8, // Reduce confidence for partial matches\r\n            entities: this.extractEntities(message, intentName)\r\n          };\r\n        }\r\n      }\r\n    }\r\n\r\n    // Third, specific keyword-based detection (lowest priority, most specific)\r\n    if (bestMatch.confidence < 0.6) {\r\n      // Statement-related requests (must be very specific)\r\n      if ((lowerMessage.includes('statement') || lowerMessage.includes('download')) && \r\n          (lowerMessage.includes('account') || lowerMessage.includes('bank'))) {\r\n        return { intent: 'account_statement', confidence: 0.75, entities: this.extractEntities(message, 'account_statement') };\r\n      }\r\n      \r\n      if ((lowerMessage.includes('statement') || lowerMessage.includes('report')) && \r\n          lowerMessage.includes('transaction')) {\r\n        return { intent: 'transaction_report', confidence: 0.75, entities: this.extractEntities(message, 'transaction_report') };\r\n      }\r\n      \r\n      if (lowerMessage.includes('statement') && lowerMessage.includes('tax')) {\r\n        return { intent: 'tax_statement', confidence: 0.75, entities: this.extractEntities(message, 'tax_statement') };\r\n      }\r\n      \r\n      // Balance inquiries\r\n      if ((lowerMessage.includes('balance') || lowerMessage.includes('money')) && \r\n          (lowerMessage.includes('check') || lowerMessage.includes('show') || lowerMessage.includes('how much'))) {\r\n        return { intent: 'balance_inquiry', confidence: 0.75, entities: this.extractEntities(message, 'balance_inquiry') };\r\n      }\r\n      \r\n      // Transaction history (be more specific)\r\n      if ((lowerMessage.includes('transaction') && lowerMessage.includes('history')) ||\r\n          (lowerMessage.includes('recent') && lowerMessage.includes('transaction'))) {\r\n        return { intent: 'transaction_history', confidence: 0.7, entities: this.extractEntities(message, 'transaction_history') };\r\n      }\r\n      \r\n      // Generic statement download (only if explicitly mentioned)\r\n      if ((lowerMessage.includes('download') && lowerMessage.includes('statement')) ||\r\n          (lowerMessage.includes('get') && lowerMessage.includes('statement'))) {\r\n        return { intent: 'download_statement', confidence: 0.65, entities: this.extractEntities(message, 'download_statement') };\r\n      }\r\n    }\r\n\r\n    // Return best match only if confidence is reasonable\r\n    return bestMatch.confidence > 0.6 ? bestMatch : {\r\n      intent: 'unknown',\r\n      confidence: 0.1\r\n    };\r\n  }\r\n\r\n  private extractEntities(message: string, intent: string): { [key: string]: any } {\r\n    const entities: { [key: string]: any } = {};\r\n    const lowerMessage = message.toLowerCase();\r\n\r\n    // Extract amounts\r\n    const amountMatch = message.match(/\\$?(\\d+(?:,\\d{3})*(?:\\.\\d{2})?)/);\r\n    if (amountMatch) {\r\n      entities['amount'] = parseFloat(amountMatch[1].replace(/,/g, ''));\r\n    }\r\n\r\n    // Extract account types\r\n    if (lowerMessage.includes('saving')) entities['accountType'] = 'SAVINGS';\r\n    if (lowerMessage.includes('checking')) entities['accountType'] = 'CHECKING';\r\n\r\n    return entities;\r\n  }\r\n\r\n  private generateResponse(intent: ChatIntent, originalMessage: string): ChatMessage {\r\n    const intentData = this.bankingIntents[intent.intent as keyof typeof this.bankingIntents];\r\n    let response: ChatMessage;\r\n\r\n    if (!intentData) {\r\n      response = this.generateUnknownResponse(originalMessage);\r\n    } else if ((intentData as any).requiresAuth && !this.authService.getToken()) {\r\n      response = this.generateAuthRequiredResponse();\r\n    } else {\r\n      response = this.generateIntentResponse(intent, intentData);\r\n    }\r\n\r\n    // Add response to chat and hide typing indicator\r\n    setTimeout(() => {\r\n      const currentMessages = this.messagesSubject.value;\r\n      this.messagesSubject.next([...currentMessages, response]);\r\n      this.isTypingSubject.next(false);\r\n    }, 100);\r\n\r\n    return response;\r\n  }\r\n\r\n  private generateIntentResponse(intent: ChatIntent, intentData: any): ChatMessage {\r\n    const randomResponse = intentData.responses[Math.floor(Math.random() * intentData.responses.length)];\r\n    \r\n    const response: ChatMessage = {\r\n      id: this.generateMessageId(),\r\n      content: randomResponse,\r\n      timestamp: new Date(),\r\n      isFromUser: false,\r\n      type: 'text',\r\n      intent: intent.intent,\r\n      quickReplies: intentData.quickReplies\r\n    };\r\n\r\n    // Add special handling for specific intents\r\n    switch (intent.intent) {\r\n      case 'balance_inquiry':\r\n        response.type = 'card';\r\n        response.cardData = this.generateBalanceCard();\r\n        break;\r\n      case 'transaction_history':\r\n        response.type = 'card';\r\n        response.cardData = this.generateTransactionCard();\r\n        break;\r\n      case 'account_info':\r\n        response.type = 'card';\r\n        response.cardData = this.generateAccountCard();\r\n        break;\r\n      case 'digital_wallet':\r\n        response.type = 'card';\r\n        response.cardData = this.generateDigitalWalletCard();\r\n        break;\r\n      case 'qr_payments':\r\n        response.type = 'card';\r\n        response.cardData = this.generateQRPaymentCard();\r\n        break;\r\n      case 'cryptocurrency':\r\n        response.type = 'card';\r\n        response.cardData = this.generateCryptoWalletCard();\r\n        break;\r\n      case 'loyalty_points':\r\n        response.type = 'card';\r\n        response.cardData = this.generateLoyaltyPointsCard();\r\n        break;\r\n      case 'social_payments':\r\n        response.type = 'card';\r\n        response.cardData = this.generateSocialPaymentsCard();\r\n        break;\r\n      case 'contactless_payments':\r\n        response.type = 'card';\r\n        response.cardData = this.generateContactlessPaymentsCard();\r\n        break;\r\n      case 'account_statement':\r\n        response.type = 'card';\r\n        response.cardData = this.generateStatementDownloadCard('account');\r\n        break;\r\n      case 'transaction_report':\r\n        response.type = 'card';\r\n        response.cardData = this.generateStatementDownloadCard('transaction');\r\n        break;\r\n      case 'tax_statement':\r\n        response.type = 'card';\r\n        response.cardData = this.generateStatementDownloadCard('tax');\r\n        break;\r\n      case 'loan_statement':\r\n        response.type = 'card';\r\n        response.cardData = this.generateStatementDownloadCard('loan');\r\n        break;\r\n      case 'investment_statement':\r\n        response.type = 'card';\r\n        response.cardData = this.generateStatementDownloadCard('investment');\r\n        break;\r\n      case 'download_statement':\r\n        response.type = 'card';\r\n        response.cardData = this.generateStatementOptionsCard();\r\n        break;\r\n    }\r\n\r\n    return response;\r\n  }\r\n\r\n  private generateBalanceCard(): any {\r\n    // Mock account data - in real app, this would come from AccountService\r\n    return {\r\n      type: 'balance',\r\n      accounts: [\r\n        { name: 'Savings Account', number: '****4567', balance: 15750.50 },\r\n        { name: 'Checking Account', number: '****4568', balance: 8240.25 }\r\n      ],\r\n      totalBalance: 23990.75\r\n    };\r\n  }\r\n\r\n  private generateTransactionCard(): any {\r\n    return {\r\n      type: 'transactions',\r\n      transactions: [\r\n        { description: 'Coffee Shop', amount: -4.50, date: new Date(), category: 'Food & Dining' },\r\n        { description: 'Salary Deposit', amount: 3500.00, date: new Date(Date.now() - 86400000), category: 'Income' },\r\n        { description: 'Electric Bill', amount: -85.50, date: new Date(Date.now() - 172800000), category: 'Utilities' }\r\n      ]\r\n    };\r\n  }\r\n\r\n  private generateAccountCard(): any {\r\n    return {\r\n      type: 'accounts',\r\n      accounts: [\r\n        { \r\n          type: 'Savings', \r\n          number: 'ACC1001234567', \r\n          balance: 15750.50, \r\n          status: 'Active',\r\n          openDate: '2020-01-15'\r\n        },\r\n        { \r\n          type: 'Checking', \r\n          number: 'ACC1001234568', \r\n          balance: 8240.25, \r\n          status: 'Active',\r\n          openDate: '2020-01-15'\r\n        }\r\n      ]\r\n    };\r\n  }\r\n\r\n  private generateUnknownResponse(message: string): ChatMessage {\r\n    const responses = [\r\n      '🤔 Hmm, that wish is beyond my magical powers! Could you try rephrasing it?',\r\n      '🧞‍♂️ My genie magic didn\\'t catch that! Can you ask about accounts, transfers, or bill payments?',\r\n      '✨ I\\'m still learning new spells! Try asking about balances, transactions, or money transfers.',\r\n      '🔮 The crystal ball is a bit cloudy on that one! Please ask about banking topics.',\r\n    ];\r\n\r\n    return {\r\n      id: this.generateMessageId(),\r\n      content: responses[Math.floor(Math.random() * responses.length)],\r\n      timestamp: new Date(),\r\n      isFromUser: false,\r\n      type: 'text',\r\n      quickReplies: ['Check Balance', 'Transfer Money', 'Pay Bills', 'Help'],\r\n      intent: 'unknown'\r\n    };\r\n  }\r\n\r\n  private generateAuthRequiredResponse(): ChatMessage {\r\n    return {\r\n      id: this.generateMessageId(),\r\n      content: '🔐 Oops! I need you to be logged into your magical banking realm first. Please sign in to unlock my full genie powers!',\r\n      timestamp: new Date(),\r\n      isFromUser: false,\r\n      type: 'text',\r\n      intent: 'auth_required'\r\n    };\r\n  }\r\n\r\n  clearChat(): void {\r\n    this.messagesSubject.next([]);\r\n    this.initializeChat();\r\n  }\r\n\r\n  private generateMessageId(): string {\r\n    return 'msg_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);\r\n  }\r\n\r\n  private generateSessionId(): string {\r\n    return 'session_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);\r\n  }\r\n\r\n  getMessages(): ChatMessage[] {\r\n    return this.messagesSubject.value;\r\n  }\r\n\r\n  // Modern Banking Features Card Generators\r\n  private generateDigitalWalletCard(): any {\r\n    return {\r\n      type: 'digital_wallet',\r\n      walletBalance: 1250.75,\r\n      linkedCards: [\r\n        { type: 'Visa', last4: '4532', isDefault: true },\r\n        { type: 'Mastercard', last4: '8901', isDefault: false }\r\n      ],\r\n      recentTransactions: [\r\n        { merchant: 'Starbucks Coffee', amount: -5.49, date: new Date(), method: 'Tap to Pay' },\r\n        { merchant: 'Uber Ride', amount: -12.30, date: new Date(Date.now() - 3600000), method: 'Digital Wallet' },\r\n        { merchant: 'Amazon Purchase', amount: -89.99, date: new Date(Date.now() - 7200000), method: 'Online Payment' }\r\n      ],\r\n      features: ['Tap to Pay', 'QR Payments', 'P2P Transfers', 'Bill Splitting']\r\n    };\r\n  }\r\n\r\n  private generateQRPaymentCard(): any {\r\n    return {\r\n      type: 'qr_payments',\r\n      qrCode: 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTAwIiBoZWlnaHQ9IjEwMCI+PGcgZmlsbD0iIzAwMCI+PHJlY3Qgd2lkdGg9IjEwMCIgaGVpZ2h0PSIxMDAiLz48L2c+PC9zdmc+',\r\n      paymentAmount: 0,\r\n      merchantName: 'QuickPay QR',\r\n      recentQRPayments: [\r\n        { merchant: 'Local Coffee Shop', amount: 8.50, date: new Date(), success: true },\r\n        { merchant: 'Street Food Vendor', amount: 15.75, date: new Date(Date.now() - 86400000), success: true },\r\n        { merchant: 'Parking Meter', amount: 2.00, date: new Date(Date.now() - 172800000), success: true }\r\n      ],\r\n      features: ['Instant QR Generation', 'Scan & Pay', 'Merchant QR', 'P2P QR Codes']\r\n    };\r\n  }\r\n\r\n  private generateCryptoWalletCard(): any {\r\n    return {\r\n      type: 'crypto_wallet',\r\n      totalValue: 4567.89,\r\n      currencies: [\r\n        { name: 'Bitcoin', symbol: 'BTC', amount: 0.0789, value: 2845.32, change: +5.67 },\r\n        { name: 'Ethereum', symbol: 'ETH', amount: 1.2456, value: 1432.87, change: -2.34 },\r\n        { name: 'Cardano', symbol: 'ADA', amount: 1250.00, value: 289.70, change: +12.45 }\r\n      ],\r\n      features: ['View Only', 'Price Tracking', 'Portfolio Analytics', 'Market News']\r\n    };\r\n  }\r\n\r\n  private generateLoyaltyPointsCard(): any {\r\n    return {\r\n      type: 'loyalty_points',\r\n      totalPoints: 15750,\r\n      cashValue: 157.50,\r\n      tier: 'Gold Member',\r\n      pointsToNextTier: 4250,\r\n      recentEarnings: [\r\n        { source: 'Credit Card Purchase', points: 125, date: new Date() },\r\n        { source: 'Monthly Bonus', points: 500, date: new Date(Date.now() - 86400000) },\r\n        { source: 'Referral Bonus', points: 1000, date: new Date(Date.now() - 172800000) }\r\n      ],\r\n      availableRewards: [\r\n        { name: '$10 Cashback', cost: 1000, category: 'Cash' },\r\n        { name: 'Coffee Voucher', cost: 500, category: 'Food' },\r\n        { name: 'Movie Ticket', cost: 1500, category: 'Entertainment' }\r\n      ]\r\n    };\r\n  }\r\n\r\n  private generateSocialPaymentsCard(): any {\r\n    return {\r\n      type: 'social_payments',\r\n      connectedPlatforms: ['Facebook', 'Instagram', 'WhatsApp', 'Telegram'],\r\n      recentRequests: [\r\n        { friend: 'John Smith', amount: 25.00, reason: 'Dinner split', status: 'pending' },\r\n        { friend: 'Sarah Wilson', amount: 15.50, reason: 'Movie tickets', status: 'completed' },\r\n        { friend: 'Mike Johnson', amount: 40.00, reason: 'Gas money', status: 'completed' }\r\n      ],\r\n      quickActions: ['Request Money', 'Send Money', 'Split Bill', 'Group Payment'],\r\n      socialFeatures: ['Contact Integration', 'Payment Reminders', 'Social Feed', 'Group Chats']\r\n    };\r\n  }\r\n\r\n  private generateContactlessPaymentsCard(): any {\r\n    return {\r\n      type: 'contactless_payments',\r\n      nfcEnabled: true,\r\n      dailyLimit: 100.00,\r\n      dailyUsed: 23.45,\r\n      monthlyTransactions: 47,\r\n      recentContactless: [\r\n        { merchant: 'Metro Transit', amount: 2.75, date: new Date(), method: 'NFC' },\r\n        { merchant: 'Grocery Store', amount: 45.67, date: new Date(Date.now() - 3600000), method: 'Tap Card' },\r\n        { merchant: 'Gas Station', amount: 15.00, date: new Date(Date.now() - 7200000), method: 'Mobile NFC' }\r\n      ],\r\n      supportedMethods: ['NFC Phone', 'Contactless Card', 'Smartwatch', 'Wearables']\r\n    };\r\n  }\r\n\r\n  private generateStatementDownloadCard(statementType: string): any {\r\n    return {\r\n      type: 'statement_download',\r\n      statementType: statementType,\r\n      title: this.getStatementTitle(statementType),\r\n      description: this.getStatementDescription(statementType),\r\n      icon: this.getStatementIcon(statementType),\r\n      downloadOptions: [\r\n        { \r\n          period: 'This Month',\r\n          filename: `${statementType}_statement_${new Date().getMonth() + 1}_${new Date().getFullYear()}`,\r\n          size: '245 KB'\r\n        },\r\n        { \r\n          period: 'Last Month',\r\n          filename: `${statementType}_statement_${new Date().getMonth()}_${new Date().getFullYear()}`,\r\n          size: '189 KB'\r\n        },\r\n        { \r\n          period: 'Last 3 Months',\r\n          filename: `${statementType}_statement_3months_${new Date().getFullYear()}`,\r\n          size: '567 KB'\r\n        },\r\n        { \r\n          period: 'Custom Period',\r\n          filename: `${statementType}_statement_custom`,\r\n          size: 'Variable'\r\n        }\r\n      ],\r\n      quickActions: [\r\n        'Download PDF',\r\n        'Email Statement',\r\n        'View Online',\r\n        'Schedule Regular Delivery'\r\n      ]\r\n    };\r\n  }\r\n\r\n  private generateStatementOptionsCard(): any {\r\n    return {\r\n      type: 'statement_options',\r\n      title: '📋 Statement Magic Portal',\r\n      description: 'Choose your preferred statement type to conjure',\r\n      statementTypes: [\r\n        {\r\n          type: 'account',\r\n          title: 'Account Statement',\r\n          description: 'Complete account summary with all transactions',\r\n          icon: '🏦',\r\n          color: '#4CAF50'\r\n        },\r\n        {\r\n          type: 'transaction',\r\n          title: 'Transaction Report',\r\n          description: 'Detailed spending and income analysis',\r\n          icon: '📊',\r\n          color: '#2196F3'\r\n        },\r\n        {\r\n          type: 'tax',\r\n          title: 'Tax Statement',\r\n          description: 'Annual tax documents and summaries',\r\n          icon: '🧾',\r\n          color: '#FF9800'\r\n        },\r\n        {\r\n          type: 'loan',\r\n          title: 'Loan Statement',\r\n          description: 'EMI history and outstanding balance',\r\n          icon: '🏠',\r\n          color: '#9C27B0'\r\n        },\r\n        {\r\n          type: 'investment',\r\n          title: 'Investment Report',\r\n          description: 'Portfolio performance and holdings',\r\n          icon: '📈',\r\n          color: '#F44336'\r\n        },\r\n        {\r\n          type: 'digital_wallet',\r\n          title: 'Digital Wallet Statement',\r\n          description: 'Mobile wallet transactions and balance',\r\n          icon: '📱',\r\n          color: '#00BCD4'\r\n        }\r\n      ]\r\n    };\r\n  }\r\n\r\n  private getStatementTitle(type: string): string {\r\n    const titles = {\r\n      'account': '🏦 Account Statement',\r\n      'transaction': '📊 Transaction Report',\r\n      'tax': '🧾 Tax Statement',\r\n      'loan': '🏠 Loan Statement',\r\n      'investment': '📈 Investment Report',\r\n      'digital_wallet': '📱 Digital Wallet Statement'\r\n    };\r\n    return titles[type as keyof typeof titles] || '📄 Statement';\r\n  }\r\n\r\n  private getStatementDescription(type: string): string {\r\n    const descriptions = {\r\n      'account': 'Complete account summary with balance and transaction history',\r\n      'transaction': 'Detailed analysis of all your spending and income patterns',\r\n      'tax': 'Annual tax documents with interest and investment summaries',\r\n      'loan': 'EMI payment history and outstanding loan balance details',\r\n      'investment': 'Portfolio performance report with gains and holdings',\r\n      'digital_wallet': 'Mobile wallet transactions and payment history'\r\n    };\r\n    return descriptions[type as keyof typeof descriptions] || 'Financial statement document';\r\n  }\r\n\r\n  private getStatementIcon(type: string): string {\r\n    const icons = {\r\n      'account': '🏦',\r\n      'transaction': '📊',\r\n      'tax': '🧾',\r\n      'loan': '🏠',\r\n      'investment': '📈',\r\n      'digital_wallet': '📱'\r\n    };\r\n    return icons[type as keyof typeof icons] || '📄';\r\n  }\r\n\r\n  // Method to handle statement download requests\r\n  handleStatementDownload(statementType: string, period: string): void {\r\n    const options: StatementOptions = this.createStatementOptions(statementType, period);\r\n    \r\n    switch (statementType) {\r\n      case 'account':\r\n        this.pdfStatementService.generateAccountStatement(options).subscribe((blob: Blob) => {\r\n          this.pdfStatementService.downloadStatement(blob, `account-statement-${period.toLowerCase().replace(' ', '-')}`);\r\n        });\r\n        break;\r\n      case 'transaction':\r\n        this.pdfStatementService.generateTransactionHistory(options).subscribe((blob: Blob) => {\r\n          this.pdfStatementService.downloadStatement(blob, `transaction-report-${period.toLowerCase().replace(' ', '-')}`);\r\n        });\r\n        break;\r\n      case 'tax':\r\n        this.pdfStatementService.generateTaxStatement(new Date().getFullYear()).subscribe((blob: Blob) => {\r\n          this.pdfStatementService.downloadStatement(blob, `tax-statement-${new Date().getFullYear()}`);\r\n        });\r\n        break;\r\n      case 'loan':\r\n        this.pdfStatementService.generateLoanStatement('LOAN001', options).subscribe((blob: Blob) => {\r\n          this.pdfStatementService.downloadStatement(blob, `loan-statement-${period.toLowerCase().replace(' ', '-')}`);\r\n        });\r\n        break;\r\n      case 'investment':\r\n        this.pdfStatementService.generateInvestmentStatement('PORTFOLIO001', options).subscribe((blob: Blob) => {\r\n          this.pdfStatementService.downloadStatement(blob, `investment-report-${period.toLowerCase().replace(' ', '-')}`);\r\n        });\r\n        break;\r\n      case 'digital_wallet':\r\n        this.pdfStatementService.generateDigitalWalletStatement(options).subscribe((blob: Blob) => {\r\n          this.pdfStatementService.downloadStatement(blob, `wallet-statement-${period.toLowerCase().replace(' ', '-')}`);\r\n        });\r\n        break;\r\n    }\r\n  }\r\n\r\n  private createStatementOptions(statementType: string, period: string): StatementOptions {\r\n    const now = new Date();\r\n    let startDate: Date;\r\n    let endDate: Date = new Date(now);\r\n\r\n    switch (period) {\r\n      case 'This Month':\r\n        startDate = new Date(now.getFullYear(), now.getMonth(), 1);\r\n        break;\r\n      case 'Last Month':\r\n        startDate = new Date(now.getFullYear(), now.getMonth() - 1, 1);\r\n        endDate = new Date(now.getFullYear(), now.getMonth(), 0);\r\n        break;\r\n      case 'Last 3 Months':\r\n        startDate = new Date(now.getFullYear(), now.getMonth() - 3, 1);\r\n        break;\r\n      default:\r\n        startDate = new Date(now.getFullYear(), now.getMonth() - 1, 1);\r\n    }\r\n\r\n    return {\r\n      startDate,\r\n      endDate,\r\n      statementType: period === 'This Month' ? 'monthly' : 'custom',\r\n      format: 'pdf'\r\n    };\r\n  }\r\n} "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}