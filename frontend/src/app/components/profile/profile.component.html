<!-- Profile Header -->
<div class="d-flex justify-content-between align-items-center mb-4">
  <h1 class="h3 mb-0">
    <i class="fas fa-user-circle me-2 text-primary"></i>
    My Profile
  </h1>
</div>

<!-- Loading State -->
<div *ngIf="loading" class="text-center py-5">
  <div class="spinner-border text-primary" role="status">
    <span class="visually-hidden">Loading...</span>
  </div>
  <p class="mt-3 text-muted">Loading your profile...</p>
</div>

<!-- Profile Content -->
<div *ngIf="!loading" class="row">
  <div class="col-lg-3 mb-4">
    <!-- Profile Sidebar -->
    <div class="card">
      <div class="card-body text-center">
        <div class="profile-avatar mb-3">
          <i class="fas fa-user-circle fa-5x text-primary"></i>
        </div>
        <h5 class="card-title" *ngIf="user">{{user.firstName}} {{user.lastName}}</h5>
        <p class="text-muted" *ngIf="user">{{user.email}}</p>
        <div class="d-grid gap-2">
          <button class="btn" 
                  [class.btn-primary]="activeTab === 'profile'"
                  [class.btn-outline-primary]="activeTab !== 'profile'"
                  (click)="setActiveTab('profile')">
            <i class="fas fa-user me-2"></i>
            Profile Info
          </button>
          <button class="btn"
                  [class.btn-primary]="activeTab === 'password'"
                  [class.btn-outline-primary]="activeTab !== 'password'"
                  (click)="setActiveTab('password')">
            <i class="fas fa-lock me-2"></i>
            Change Password
          </button>
        </div>
      </div>
    </div>
  </div>

  <div class="col-lg-9">
    <!-- Profile Information Tab -->
    <div *ngIf="activeTab === 'profile'" class="card">
      <div class="card-header">
        <h5 class="mb-0">
          <i class="fas fa-user me-2"></i>
          Profile Information
        </h5>
      </div>
      <div class="card-body">
        <form [formGroup]="profileForm" (ngSubmit)="onProfileSubmit()">
          <div class="row">
            <div class="col-md-6 mb-3">
              <label for="firstName" class="form-label">First Name *</label>
              <input type="text" 
                     class="form-control" 
                     id="firstName"
                     formControlName="firstName"
                     [class.is-invalid]="isFieldInvalid(profileForm, 'firstName')">
              <div *ngIf="isFieldInvalid(profileForm, 'firstName')" class="invalid-feedback">
                {{getFieldError(profileForm, 'firstName')}}
              </div>
            </div>
            <div class="col-md-6 mb-3">
              <label for="lastName" class="form-label">Last Name *</label>
              <input type="text" 
                     class="form-control" 
                     id="lastName"
                     formControlName="lastName"
                     [class.is-invalid]="isFieldInvalid(profileForm, 'lastName')">
              <div *ngIf="isFieldInvalid(profileForm, 'lastName')" class="invalid-feedback">
                {{getFieldError(profileForm, 'lastName')}}
              </div>
            </div>
          </div>

          <div class="row">
            <div class="col-md-6 mb-3">
              <label for="email" class="form-label">Email Address *</label>
              <input type="email" 
                     class="form-control" 
                     id="email"
                     formControlName="email"
                     [class.is-invalid]="isFieldInvalid(profileForm, 'email')">
              <div *ngIf="isFieldInvalid(profileForm, 'email')" class="invalid-feedback">
                {{getFieldError(profileForm, 'email')}}
              </div>
            </div>
            <div class="col-md-6 mb-3">
              <label for="phoneNumber" class="form-label">Phone Number *</label>
              <input type="tel" 
                     class="form-control" 
                     id="phoneNumber"
                     formControlName="phoneNumber"
                     placeholder="+1-555-0123"
                     [class.is-invalid]="isFieldInvalid(profileForm, 'phoneNumber')">
              <div *ngIf="isFieldInvalid(profileForm, 'phoneNumber')" class="invalid-feedback">
                {{getFieldError(profileForm, 'phoneNumber')}}
              </div>
            </div>
          </div>

          <div class="mb-3">
            <label for="address" class="form-label">Address</label>
            <input type="text" 
                   class="form-control" 
                   id="address"
                   formControlName="address"
                   placeholder="Street address">
          </div>

          <div class="row">
            <div class="col-md-4 mb-3">
              <label for="city" class="form-label">City</label>
              <input type="text" 
                     class="form-control" 
                     id="city"
                     formControlName="city">
            </div>
            <div class="col-md-4 mb-3">
              <label for="state" class="form-label">State</label>
              <input type="text" 
                     class="form-control" 
                     id="state"
                     formControlName="state">
            </div>
            <div class="col-md-4 mb-3">
              <label for="zipCode" class="form-label">ZIP Code</label>
              <input type="text" 
                     class="form-control" 
                     id="zipCode"
                     formControlName="zipCode"
                     placeholder="12345"
                     [class.is-invalid]="isFieldInvalid(profileForm, 'zipCode')">
              <div *ngIf="isFieldInvalid(profileForm, 'zipCode')" class="invalid-feedback">
                {{getFieldError(profileForm, 'zipCode')}}
              </div>
            </div>
          </div>

          <div class="row">
            <div class="col-md-6 mb-3">
              <label for="dateOfBirth" class="form-label">Date of Birth</label>
              <input type="date" 
                     class="form-control" 
                     id="dateOfBirth"
                     formControlName="dateOfBirth">
            </div>
            <div class="col-md-6 mb-3">
              <label for="occupation" class="form-label">Occupation</label>
              <input type="text" 
                     class="form-control" 
                     id="occupation"
                     formControlName="occupation">
            </div>
          </div>

          <div class="d-flex justify-content-end">
            <button type="submit" 
                    class="btn btn-primary"
                    [disabled]="updating || profileForm.invalid">
              <span *ngIf="updating" class="spinner-border spinner-border-sm me-2"></span>
              <i *ngIf="!updating" class="fas fa-save me-2"></i>
              {{updating ? 'Updating...' : 'Update Profile'}}
            </button>
          </div>
        </form>
      </div>
    </div>

    <!-- Change Password Tab -->
    <div *ngIf="activeTab === 'password'" class="card">
      <div class="card-header">
        <h5 class="mb-0">
          <i class="fas fa-lock me-2"></i>
          Change Password
        </h5>
      </div>
      <div class="card-body">
        <form [formGroup]="passwordForm" (ngSubmit)="onPasswordSubmit()">
          <div class="mb-3">
            <label for="currentPassword" class="form-label">Current Password *</label>
            <input type="password" 
                   class="form-control" 
                   id="currentPassword"
                   formControlName="currentPassword"
                   [class.is-invalid]="isFieldInvalid(passwordForm, 'currentPassword')">
            <div *ngIf="isFieldInvalid(passwordForm, 'currentPassword')" class="invalid-feedback">
              {{getFieldError(passwordForm, 'currentPassword')}}
            </div>
          </div>

          <div class="mb-3">
            <label for="newPassword" class="form-label">New Password *</label>
            <input type="password" 
                   class="form-control" 
                   id="newPassword"
                   formControlName="newPassword"
                   [class.is-invalid]="isFieldInvalid(passwordForm, 'newPassword')">
            <div *ngIf="isFieldInvalid(passwordForm, 'newPassword')" class="invalid-feedback">
              {{getFieldError(passwordForm, 'newPassword')}}
            </div>
            <div class="form-text">Password must be at least 8 characters long</div>
          </div>

          <div class="mb-3">
            <label for="confirmPassword" class="form-label">Confirm New Password *</label>
            <input type="password" 
                   class="form-control" 
                   id="confirmPassword"
                   formControlName="confirmPassword"
                   [class.is-invalid]="isFieldInvalid(passwordForm, 'confirmPassword')">
            <div *ngIf="isFieldInvalid(passwordForm, 'confirmPassword')" class="invalid-feedback">
              {{getFieldError(passwordForm, 'confirmPassword')}}
            </div>
          </div>

          <div class="alert alert-info">
            <i class="fas fa-info-circle me-2"></i>
            <strong>Password Requirements:</strong>
            <ul class="mb-0 mt-2">
              <li>At least 8 characters long</li>
              <li>Include both uppercase and lowercase letters</li>
              <li>Include at least one number</li>
              <li>Include at least one special character</li>
            </ul>
          </div>

          <div class="d-flex justify-content-end">
            <button type="submit" 
                    class="btn btn-primary"
                    [disabled]="updating || passwordForm.invalid">
              <span *ngIf="updating" class="spinner-border spinner-border-sm me-2"></span>
              <i *ngIf="!updating" class="fas fa-key me-2"></i>
              {{updating ? 'Changing...' : 'Change Password'}}
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div> 