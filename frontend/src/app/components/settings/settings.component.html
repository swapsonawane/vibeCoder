<!-- Settings Header -->
<div class="d-flex justify-content-between align-items-center mb-4">
  <h1 class="h3 mb-0">
    <i class="fas fa-cog me-2 text-primary"></i>
    Settings
  </h1>
  <button class="btn btn-outline-danger" (click)="resetToDefaults()">
    <i class="fas fa-undo me-2"></i>
    Reset to Defaults
  </button>
</div>

<!-- Loading State -->
<div *ngIf="loading" class="text-center py-5">
  <div class="spinner-border text-primary" role="status">
    <span class="visually-hidden">Loading...</span>
  </div>
  <p class="mt-3 text-muted">Loading your settings...</p>
</div>

<!-- Settings Content -->
<div *ngIf="!loading" class="row">
  <div class="col-lg-3 mb-4">
    <!-- Settings Sidebar -->
    <div class="card">
      <div class="card-body">
        <h6 class="card-title">Settings Categories</h6>
        <div class="d-grid gap-2">
          <button class="btn" 
                  [class.btn-primary]="activeTab === 'notifications'"
                  [class.btn-outline-primary]="activeTab !== 'notifications'"
                  (click)="setActiveTab('notifications')">
            <i class="fas fa-bell me-2"></i>
            Notifications
          </button>
          <button class="btn"
                  [class.btn-primary]="activeTab === 'security'"
                  [class.btn-outline-primary]="activeTab !== 'security'"
                  (click)="setActiveTab('security')">
            <i class="fas fa-shield-alt me-2"></i>
            Security
          </button>
          <button class="btn"
                  [class.btn-primary]="activeTab === 'preferences'"
                  [class.btn-outline-primary]="activeTab !== 'preferences'"
                  (click)="setActiveTab('preferences')">
            <i class="fas fa-sliders-h me-2"></i>
            Preferences
          </button>
        </div>
      </div>
    </div>
  </div>

  <div class="col-lg-9">
    <!-- Notification Settings Tab -->
    <div *ngIf="activeTab === 'notifications'" class="card">
      <div class="card-header">
        <h5 class="mb-0">
          <i class="fas fa-bell me-2"></i>
          Notification Settings
        </h5>
      </div>
      <div class="card-body">
        <form [formGroup]="notificationForm" (ngSubmit)="onNotificationSubmit()">
          <div class="row">
            <div class="col-md-6 mb-4">
              <h6 class="text-primary">Communication Preferences</h6>
              
              <div class="form-check form-switch mb-3">
                <input class="form-check-input" type="checkbox" id="emailNotifications" 
                       formControlName="emailNotifications">
                <label class="form-check-label" for="emailNotifications">
                  <i class="fas fa-envelope me-2"></i>
                  Email Notifications
                </label>
                <div class="form-text">Receive notifications via email</div>
              </div>

              <div class="form-check form-switch mb-3">
                <input class="form-check-input" type="checkbox" id="smsNotifications" 
                       formControlName="smsNotifications">
                <label class="form-check-label" for="smsNotifications">
                  <i class="fas fa-sms me-2"></i>
                  SMS Notifications
                </label>
                <div class="form-text">Receive notifications via text message</div>
              </div>

              <div class="form-check form-switch mb-3">
                <input class="form-check-input" type="checkbox" id="pushNotifications" 
                       formControlName="pushNotifications">
                <label class="form-check-label" for="pushNotifications">
                  <i class="fas fa-mobile-alt me-2"></i>
                  Push Notifications
                </label>
                <div class="form-text">Receive push notifications on your device</div>
              </div>
            </div>

            <div class="col-md-6 mb-4">
              <h6 class="text-primary">Alert Types</h6>
              
              <div class="form-check form-switch mb-3">
                <input class="form-check-input" type="checkbox" id="transactionAlerts" 
                       formControlName="transactionAlerts">
                <label class="form-check-label" for="transactionAlerts">
                  <i class="fas fa-exchange-alt me-2"></i>
                  Transaction Alerts
                </label>
                <div class="form-text">Get notified of all transactions</div>
              </div>

              <div class="form-check form-switch mb-3">
                <input class="form-check-input" type="checkbox" id="securityAlerts" 
                       formControlName="securityAlerts">
                <label class="form-check-label" for="securityAlerts">
                  <i class="fas fa-shield-alt me-2"></i>
                  Security Alerts
                </label>
                <div class="form-text">Important security notifications</div>
              </div>

              <div class="form-check form-switch mb-3">
                <input class="form-check-input" type="checkbox" id="billReminders" 
                       formControlName="billReminders">
                <label class="form-check-label" for="billReminders">
                  <i class="fas fa-file-invoice me-2"></i>
                  Bill Reminders
                </label>
                <div class="form-text">Reminders for upcoming bills</div>
              </div>

              <div class="form-check form-switch mb-3">
                <input class="form-check-input" type="checkbox" id="lowBalanceAlerts" 
                       formControlName="lowBalanceAlerts">
                <label class="form-check-label" for="lowBalanceAlerts">
                  <i class="fas fa-exclamation-triangle me-2"></i>
                  Low Balance Alerts
                </label>
                <div class="form-text">Alert when account balance is low</div>
              </div>
            </div>
          </div>

          <div class="row">
            <div class="col-12">
              <h6 class="text-primary">Marketing</h6>
              <div class="form-check form-switch mb-3">
                <input class="form-check-input" type="checkbox" id="marketingEmails" 
                       formControlName="marketingEmails">
                <label class="form-check-label" for="marketingEmails">
                  <i class="fas fa-bullhorn me-2"></i>
                  Marketing Emails
                </label>
                <div class="form-text">Receive promotional emails and offers</div>
              </div>
            </div>
          </div>

          <div class="d-flex justify-content-end">
            <button type="submit" 
                    class="btn btn-primary"
                    [disabled]="updating">
              <span *ngIf="updating" class="spinner-border spinner-border-sm me-2"></span>
              <i *ngIf="!updating" class="fas fa-save me-2"></i>
              {{updating ? 'Updating...' : 'Save Notification Settings'}}
            </button>
          </div>
        </form>
      </div>
    </div>

    <!-- Security Settings Tab -->
    <div *ngIf="activeTab === 'security'" class="card">
      <div class="card-header">
        <h5 class="mb-0">
          <i class="fas fa-shield-alt me-2"></i>
          Security Settings
        </h5>
      </div>
      <div class="card-body">
        <form [formGroup]="securityForm" (ngSubmit)="onSecuritySubmit()">
          <div class="row">
            <div class="col-md-6 mb-4">
              <h6 class="text-primary">Authentication</h6>
              
              <div class="form-check form-switch mb-3">
                <input class="form-check-input" type="checkbox" id="twoFactorAuth" 
                       formControlName="twoFactorAuth">
                <label class="form-check-label" for="twoFactorAuth">
                  <i class="fas fa-mobile-alt me-2"></i>
                  Two-Factor Authentication
                </label>
                <div class="form-text">Add an extra layer of security to your account</div>
              </div>

              <div class="form-check form-switch mb-3">
                <input class="form-check-input" type="checkbox" id="biometricLogin" 
                       formControlName="biometricLogin">
                <label class="form-check-label" for="biometricLogin">
                  <i class="fas fa-fingerprint me-2"></i>
                  Biometric Login
                </label>
                <div class="form-text">Use fingerprint or face recognition</div>
              </div>

              <div class="mb-3">
                <label for="sessionTimeout" class="form-label">
                  <i class="fas fa-clock me-2"></i>
                  Session Timeout (minutes)
                </label>
                <select class="form-control" id="sessionTimeout" formControlName="sessionTimeout">
                  <option value="15">15 minutes</option>
                  <option value="30">30 minutes</option>
                  <option value="60">1 hour</option>
                  <option value="120">2 hours</option>
                  <option value="240">4 hours</option>
                </select>
                <div class="form-text">Automatically log out after inactivity</div>
              </div>
            </div>

            <div class="col-md-6 mb-4">
              <h6 class="text-primary">Monitoring</h6>
              
              <div class="form-check form-switch mb-3">
                <input class="form-check-input" type="checkbox" id="loginAlerts" 
                       formControlName="loginAlerts">
                <label class="form-check-label" for="loginAlerts">
                  <i class="fas fa-sign-in-alt me-2"></i>
                  Login Alerts
                </label>
                <div class="form-text">Get notified of new login attempts</div>
              </div>

              <div class="form-check form-switch mb-3">
                <input class="form-check-input" type="checkbox" id="deviceTracking" 
                       formControlName="deviceTracking">
                <label class="form-check-label" for="deviceTracking">
                  <i class="fas fa-laptop me-2"></i>
                  Device Tracking
                </label>
                <div class="form-text">Track and manage trusted devices</div>
              </div>
            </div>
          </div>

          <div class="alert alert-info">
            <i class="fas fa-info-circle me-2"></i>
            <strong>Security Tip:</strong> Enable two-factor authentication and regular security alerts to keep your account secure.
          </div>

          <div class="d-flex justify-content-end">
            <button type="submit" 
                    class="btn btn-primary"
                    [disabled]="updating">
              <span *ngIf="updating" class="spinner-border spinner-border-sm me-2"></span>
              <i *ngIf="!updating" class="fas fa-save me-2"></i>
              {{updating ? 'Updating...' : 'Save Security Settings'}}
            </button>
          </div>
        </form>
      </div>
    </div>

    <!-- Preferences Tab -->
    <div *ngIf="activeTab === 'preferences'" class="card">
      <div class="card-header">
        <h5 class="mb-0">
          <i class="fas fa-sliders-h me-2"></i>
          User Preferences
        </h5>
      </div>
      <div class="card-body">
        <form [formGroup]="preferencesForm" (ngSubmit)="onPreferencesSubmit()">
          <div class="row">
            <div class="col-md-6 mb-4">
              <h6 class="text-primary">Localization</h6>
              
              <div class="mb-3">
                <label for="language" class="form-label">
                  <i class="fas fa-language me-2"></i>
                  Language
                </label>
                <select class="form-control" id="language" formControlName="language">
                  <option value="en">English</option>
                  <option value="es">Español</option>
                  <option value="fr">Français</option>
                  <option value="de">Deutsch</option>
                </select>
              </div>

              <div class="mb-3">
                <label for="currency" class="form-label">
                  <i class="fas fa-dollar-sign me-2"></i>
                  Currency
                </label>
                <select class="form-control" id="currency" formControlName="currency">
                  <option value="USD">USD - US Dollar</option>
                  <option value="EUR">EUR - Euro</option>
                  <option value="GBP">GBP - British Pound</option>
                  <option value="CAD">CAD - Canadian Dollar</option>
                </select>
              </div>

              <div class="mb-3">
                <label for="dateFormat" class="form-label">
                  <i class="fas fa-calendar me-2"></i>
                  Date Format
                </label>
                <select class="form-control" id="dateFormat" formControlName="dateFormat">
                  <option value="MM/DD/YYYY">MM/DD/YYYY</option>
                  <option value="DD/MM/YYYY">DD/MM/YYYY</option>
                  <option value="YYYY-MM-DD">YYYY-MM-DD</option>
                </select>
              </div>

              <div class="mb-3">
                <label for="timeFormat" class="form-label">
                  <i class="fas fa-clock me-2"></i>
                  Time Format
                </label>
                <select class="form-control" id="timeFormat" formControlName="timeFormat">
                  <option value="12">12-hour (AM/PM)</option>
                  <option value="24">24-hour</option>
                </select>
              </div>
            </div>

            <div class="col-md-6 mb-4">
              <h6 class="text-primary">Display</h6>
              
              <div class="mb-3">
                <label for="theme" class="form-label">
                  <i class="fas fa-palette me-2"></i>
                  Theme
                </label>
                <select class="form-control" id="theme" formControlName="theme">
                  <option value="light">Light</option>
                  <option value="dark">Dark</option>
                  <option value="auto">Auto (System)</option>
                </select>
              </div>

              <div class="mb-3">
                <label for="transactionsPerPage" class="form-label">
                  <i class="fas fa-list me-2"></i>
                  Transactions per Page
                </label>
                <select class="form-control" id="transactionsPerPage" formControlName="transactionsPerPage">
                  <option value="5">5</option>
                  <option value="10">10</option>
                  <option value="25">25</option>
                  <option value="50">50</option>
                </select>
              </div>

              <div class="mb-3">
                <label for="defaultAccount" class="form-label">
                  <i class="fas fa-wallet me-2"></i>
                  Default Account
                </label>
                <select class="form-control" id="defaultAccount" formControlName="defaultAccount">
                  <option value="">No preference</option>
                  <option value="savings">Savings Account</option>
                  <option value="checking">Checking Account</option>
                </select>
                <div class="form-text">Default account for transfers and payments</div>
              </div>
            </div>
          </div>

          <div class="d-flex justify-content-end">
            <button type="submit" 
                    class="btn btn-primary"
                    [disabled]="updating">
              <span *ngIf="updating" class="spinner-border spinner-border-sm me-2"></span>
              <i *ngIf="!updating" class="fas fa-save me-2"></i>
              {{updating ? 'Updating...' : 'Save Preferences'}}
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div> 